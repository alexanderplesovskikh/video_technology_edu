# Практика

Попробуем собрать простейшую домашнюю телестудию, чтобы вести запись спикера и его экрана и в реальном времени делать монтаж. Например, это пригодится, чтобы вести вебинар или записывать видеолекцию. Можно будет переключаться между сценой, где показывается спикер, презентацией и компоновкой обоих видов. Можно использовать заставки, титры, вставлять видеозаписи.

# Оборудование и программное обеспечение

1. OBS умеет получать видео с веб-камеры, подключенной к компьютеру. Вы можете использовать несколько веб-камер.
2. Презентация пока будет запускаться на этом же компьютере, для нее нам понадобится второй монитор – мы будем захватывать изображение с монитора. Вместо презентации может быть демонстрация действий на экране – часто в учебных видеороликах показывают, как решаются какие-нибудь практические задачи, демонстрируя действия на экране (screencast).
3. Для записи голоса вам понадобится микрофон. В тренировочных целях подойдет микрофон веб-камеры или встроенный микрофон ноутбука.  
   Звук – это важнейшая часть видеопродукта, но сейчас нам важно, чтобы он просто был, особенностями звукотехники займемся позже.

Наша первая задача – получить изображение с камеры и экрана, а также звук с микрофона в одной программе – видеомикшере, и на лету менять отображаемую сцену, записывать это в файл.

На компьютере будет работать OBS – программа, которую мы используем в качестве видеомикшера. Это известная бесплатная программа с открытым кодом. Здесь мы соберем аудио и видеопотоки от всех источников.

# Настройка микшера OBS

Начнем с видеомикшера OBS. Подробную инструкцию вы найдете в материалах урока, здесь – короткая демонстрация.

Поскольку мы используем веб-камеру, получение изображения не потребует установки дополнений. Добавляем сцену с камерой на весь экран.

Экран мы захватываем на том же компьютере, где микшер, это делается без дополнительных усилий средствами микшера OBS.

Звук мы тоже получаем со звуковой карты компьютера, нужно просто убедиться, что OBS показывает нужный вам источник звука.

Теперь создадим сцены.

В OBS есть понятия “сцена” и “источник”. Сцена может состоять из нескольких источников. Источники – это камера, захват экрана, видеофайл и так далее.

При этом, в одной сцене источник может занимать весь экран, в другой уменьшиться до части экрана и показываться рядом с другим источником.

Такой подход ориентирует вас на работу с компоновками и отличается от классических видеомикшеров, ориентированных в первую очередь на источники, а видеооформление и компоновка сцен являются дополнением к обычному переключению источников.

Пусть в одной сцене у вас будет в полный экран изображение с камеры, в другой – захват второго экрана, в третьей – экран и камера вместе на фоне какой-нибудь картинки.

Обратите внимание на кнопку “режим студии” справа. В режиме студии вы видите два экрана: слева предпросмотр, справа программа. Это обычный для видеомикшеров интерфейс: сцена сперва выбирается в предпросмотр, режиссер убеждается, что там все в порядке, дальше делается переход в программный выход.

Программный выход – это то, что видят зрители в записи или в реальном времени. Например, в трансляции или видеоконференции.

Теперь, переключая сцены и выводя их в программный выход, вы можете оживлять свои выступления изменением видеоряда. Нажимаете запись и получаете видео, которое вы смонтировали на лету. Аналогично можно начать трансляцию на любую видеоплатформу, а также можно включить виртуальную камеру и показывать выход OBS как веб-камеру для сервисов видеоконференций и вебинаров.

Если не хотите тыкать мышкой в сцены во время записи, в настройках OBS можно назначить клавишные команды, и сможете переключать сцены с клавиатуры, работая при этом в другой программе.

Чтобы придать вашему видеопродукту завершенность, не хватает заставок и титров – они также накладываются в микшере.

# Подключение двух веб-камер

Вы уже знаете, как получить изображение с веб-камеры компьютера, но что если вы хотите снять себя с нескольких ракурсов? Или какой-то процесс, который делается руками, для чего камеру необходимо направить на рабочую зону?

Самый простой способ это сделать - повторить то, что вы уже умеете: подключить ещё одну веб-камеру и получить с неё картинку. Количество камер ограничивается количеством usb портов в вашем компьютере. Если портов будет не хватать, можно подключить USB-хаб.  Для демонстрации остановимся на двух камерах.

В первую сцену добавляем устройство захвата видео и выбираем первую камеру. Аналогичным образом в новой сцене создаём новый источник, но уже со второй камерой. Простейшая многокамерная съёмка готова.

Конечно это очень грубый способ решения проблемы: обычные вебки ограничены в настройках, у них, как правило, фиксированное фокусное расстояние, их удаленность от компьютера ограничена длиной USB-кабеля, пусть даже удлиненного. Бывают специальные веб-камеры, даже с автоматическим слежением  за человеком, но мы рассмотрим варианты, более пригодные для профессиональной работы. В следующих видео мы покажем вам как подключить в OBS другие типы камер.

# Подключение фотокамеры

Первое, что приходит в голову каждому, кто пытается снять видео - использовать для этого фотоаппарат. Не любая модель умеет выдавать чистый HDMI без дополнительной информации на выход, мы сейчас будем работать с таким.

Нам понадобится кабель HDMI - mini HDMI. У фотоаппарата сбоку есть mini HDMI выход, как раз для передачи картинки.

Теперь фотоаппарат готов отдавать картинку, но компьютер ещё не может её принять. Видеоразъемы в компьютере предназначены для вывода изображения, а не захвата. Для захвата видео потребуется дополнительное устройство. Они бывают внешними, подключаемыми по USB, а бывают в виде платы расширения. Плата вставляется в корпус настольного компьютера, устройства USB могут работать с любыми моделями компьютеров, включая ноутбуки. Разница в том, что платы, которые ставятся в настольные компьютеры, часто имеют профессиональное назначение и выдают менее сжатый поток – для обработки, а не просмотра. USB-устройства, как правило, предназначены для “пользовательских” целей. Например, сделать из вашего фотоаппарата качественную вебку для видеосвязи, если этот аппарат сам не умеет отдавать поток по USB, притворяясь вебкамерой.

# Подключение IP камеры

IP-камера подключается по сети: как по проводной, так и по вайфай. Для видеопроизводства нежелательно использовать вайфай, но даже при проводном соединении мы увидим неоспоримое удобство сетевых камер: они не привязаны непосредственно к компьютеру, где работает видеомикшер. Вы можете подключить камеру в любой точке вашей локальной сети и даже удаленно, но это сложнее. Изображение камера передаёт в сжатом виде, упаковывая его кодеком. Как правило – H.264 или H.265.

Вы уже знакомы с плагином Gstreamer для видеомикшера OBS. Сейчас он вновь пригодится.

Чтобы добавить IP-камеру в обс вам нужно написать вот этот пайплайн в источнике Gstreamer. Обратите внимание, что теперь пайплайн заканчивается именем элемента “video.”, так как теперь на выходе мы хотим получить картинку, а не звук.

Для того, чтобы картинка приходила в реальном времени, уберите эти галочки. Готово. Мы получили картинку с камеры.

Ещё одно интересное решение - использование телефона в качестве камеры. Можно установить на телефон приложение, которое позволит телефону играть роль IP-камеры. Мы используем Ip-webcam, но вы можете использовать любой из аналогов. Телефон получит возможность отдавать видео со своей камеры через RTSP-поток. Этот поток можно будет добавить в пайплайн, который мы давали ранее. Вуаля. Теперь у вас есть ещё одна камера.

Также есть платное приложение для NDI, через которое тоже можно получить поток. Но в обычной домашней сети вы вряд ли получите плавный видеопоток высокого разрешения. NDI требует около 100 мегабит в секунду для картинки Full HD, бытовые точки доступа вайфай плохо справляются с такими потоками.

IP камера будет работать только если ваш компьютер и камера находятся в одной сети, или пользуются одним интернетом. Иначе компьютер не сможет получить доступ к камере и принять поток с неё. Например, если ваш телефон ловит Wi-Fi сигнал с того же роутера, что и ваш компьютер, то они находятся в одной сети. Если же телефон выходит в интернет с помощью сотовой сети, то компьютер, подключенный к домашнему роутеру не увидит телефон. Позже мы освоим использование VPN для подключения удаленных камер, но пока будем включать камеры в одну локальную сеть, причем, в один ее сегмент. Да, локальные сети тоже могут быть неоднородными. В домашних сетях, как правило, есть только один сегмент – вот им и будем пользоваться.

# Заключение

Пока вы проводите съёмку в небольшом помещении, где до любой нужной вам точки можно дотянуться проводами, вы можете использовать бытовые решения: снимать на  USB-камеры или захватывать сигнал с фото- и видеокамер.

Также можно использовать видеомикшер – не программу, а отдельное устройство. Есть много недорогих моделей для HDMI устройств. Для простого монтажа их вполне достаточно.

Сетевые решения начинают быть незаменимыми в двух случаях:

1. При необходимости вести распределенную работу или даже когда место съёмки находится не рядом с режиссерским местом и тянуть специальные провода сложно или дорого.
2. Когда нужна автоматизация. Если мы работаем с однотипными медиапотоками в сети, мы можем их принимать не только на микшере режиссера, но и обрабатывать программно. Машинное зрение, нейросети – современные технологии позволяют нам решать множество задач, которые ранее требовали работы людей. Мы можем следить за человеком при помощи PTZ камеры, можем распознавать лица и автоматически подбирать титры и так далее.

В этом курсе мы минимально касаемся классических телевизионных технологий, сосредоточимся на приложении сетевых видеотехнологий к решению задач видеопроизводства, которые решать обычным способом сложно или дорого.

Если вы записываете короткий ролик и в кадре будет только ваше лицо, то сценарий может быть у вас в голове. Если вы записываете длинную лекцию под слайды, как в онлайн-курсах, то чаще всего эти слайды и есть ваш сценарий.

Отдельный сценарий нужен, когда над видеопродуктом работает несколько человек и появляется монтаж.

О сценарном искусстве мы говорить не будем, об этом лучше слушать сценаристов, здесь – коротко про формат сценария.

В ролике, где нужно менять планы, ракурс, двигать камеру, делать видеовставки, показывать слайды или картинку-в-картинке, нужно связать между собой этот сложный видеоряд и звуковую дорожку – дикторский текст, музыку, звуковые эффекты.

Для этого лучше всего использовать таблицу, где столбцы – это составляющие ролика. К ним относятся:

- текст диктора,
- план или номер камеры,
- действие оператора,
- номер слайда из презентации или название видеоролика,
- тип компоновки – полный экран или картинка-в-катинке (PiP),
- звуковые эффекты

Каждая строка – это кадр, кадры группируются в сцены.

Удобно нумеровать сцены и кадры двухуровневым списком: сцена 1, кадр 2 – в списке 1.2. Тогда при вставке кадра в середину сцены нумерация будет меняться только внутри одной сцены.

Сценарий может редактировать несколько человек, в этом случае удобно использовать сетевые документы, а не обмениваться файлами – так вы избавитесь от конфликта версий.

> Предмет для автоматизации:
>
> Сценарии могут использоваться и при автоматизации съёмки. Например, можно связать сценарий, телесуфлер, презентацию и видеомикшер. Тогда микшер будет брать информацию о том, что нужно показывать на экране, презентация будет показывать нужный слайд, а движение по сценарию будет управляться телесуфлером.

В этой статье мы будем работать с OBS. Разберём самые базовые инструменты для оформления. Дальше будут скринкасты работы, постарайтесь повторить эти примеры самостоятельно

У вас есть сцена с видео и аудио источниками. Добавим какое-нибудь оформление. Вы можете поместить на видео своё лого или другую заранее подготовленную картинку, добавив источник “Image”.

Картинке не обязательно всегда находится на экране. Она может появляться и исчезать. Таким образом можно сделать простые титры. Для этого в выбранной сцене в разделе с источниками выбираем текстовый источник, называем его, например, “Имя”. В появившемся окне в поле текст вводим имя человека. В минимальном варианте титр готов, но если фон будет неконтрастным цвету текста, текст не будет читаться. Добавим к нему плашку. Для этого в источниках выбираем “Image”. В появившемся окне нужно выбрать файл с плашкой. Теперь совместим имя и плашку. Как мы видим, плашка перекрывает надпись. Это происходит потому что OBS работает с источниками как со слоями, поэтому просто переместим источник с текстом выше источника с плашкой. Уменьшаем текст до размера плашки и изменяем цвет. Добавляем дополнительную информацию в плашку. Теперь сгруппируем все объекты, чтобы можно было управлять ими одновременно. После этого можно выключать и включать плашку, однако можно сделать более впечатляющий выход. Добавим эффекты появления и исчезания группы. Для этого выделяем группу и по правому щелчку мыши переходим в меню, в котором выбираем параметр “Swipe”. Можно посмотреть, как будет выглядеть эффект нажав на кнопку превью. Так как плашка у нас находится в левом нижнем углу поменяем направление свайпа направо. Теперь по аналогии сделаем эффект исчезновения.

Другой вариант выводить информацию на экран - сделать бегущую строку. Для начала снова создадим текстовый источник. Туда напишем текст, который мы хотим повторять на экране. Затем переходим в вкладку фильтры и выбираем Scroll. Можно менять скорость движения текста, а также направление: справа налево или снизу вверх. Вы также можете ограничить длину бегущей строки. Базовый вариант готов. Как и в случае с титрами вы можете добавить картинки за строку и перед ней для визуального улучшения строки.

С помощью этого же фильтра можно также зациклить и размножить картинку, чтобы создать динамический фон

Теперь рассмотрим добавление медиафайлов в качестве видеоперебивок. Для этого нам нужно создать отдельную сцену. В ней в источниках выбрать Media Source и указать путь к нужному видеофайлу. Отправим получившуюся сцену в эфир. Видим, что после завершения короткого видео ничего не происходит. Для того, чтобы зациклить видео нужно зайти в параметры видеоисточника и включить параметр “Loop”.

Теперь поговорим о переходах между сценами. Обычный переход – cut просто меняет источники местами. Другой стандартный переход - Fade. Он выглядит интереснее, но подходит не для всех случаев. Во вкладке scene transition можно изменять параметры переходов. Для перехода fade можно изменить его продолжительность. Помимо стандартных переходов можно использовать переход через стингер. Именно так называются все эти красивые переходы, которые вы видите в телепередачах. Для добавления стингера во вкладке scene transition выбираем Add Stinger. В появившемся окне указываем путь к файлу со стингером. Дальше важно указать transition point – кадр или миллисекунда на которой один источник должен смениться другим, обычно это последний кадр стингера при котором весь экран закрывает изображение. Видео, которое мы используем как стингер, должно иметь прозрачный фон. Иначе на экране вместо частей сцен будет чёрный экран.

OBS умеет вырезать контрастный фон из источника. Эта технология называется хромакей. Чтобы воспользоваться ей, выбираем видеоисточник и заходим в фильтры. В появившемся окне во вкладке Effect Filters добавляем фильтр Chroma Key. В параметре key color type можно выбрать убираемый цвет: стандартные – зеленый синий и маджента, или кастомный, который можно задать в цветовой палитре. Далее подстраиваем оставшиеся параметры так, чтобы удаляемый цвет убрался чисто, но при этом остальное окружение не стало прозрачным. Вы убрали зелёную стену, но теперь на этом месте ничего нет, поэтому давайте добавим фон. Это делается с помощью добавления картинки из источников в сцене. Осталось только переместить фоновое изображение под видеоисточник.

Конечно у вас дома может не быть достаточно контрастных стен, а вырезать фон всё равно будет необходимо. Для этого можно воспользоваться плагином, который добавляет такой фильтр. Работать он будет так же, как удаление фона в зуме. Из всех настроек фильтра модель сегментации SINet вырезает контур лучше всего, однако руки в таком случае не захватывает. Поставьте фоном фильтра зеленый цвет, а дальше как и в предыдущий раз удалите его с помощью хромакея. Качество у этого способа будет хуже, чем у настоящего хромакея. В профессиональном производстве такой способ не применяется, но для видео, где вам нужно выступить из неоснащенного помещения и не нужно показывать руки и вы сидите относительно спокойно этого хватит.

Плагин понадобится если у вас версия ОБС ниже 28 или ваша видеокарта не NVIDIA. В 28й версии ОБС появился фильтр, который тоже может убрать простой задний фон

## #Свет

Освещение можно классифицировать в нескольких направлениях:

- резкость теней
- угол/ракурс
- яркость
- цвет
- количество источников света

Различают направленный, рассеянный и комбинированный свет:

- Направленный свет - свет, дающий резко выраженные света и тени на объекте.
- Рассеянный свет - свет, который освещает объект равномерно и одинаково, в результате чего у объекта отсутствуют блики, тени и рефлексы.
- Комбинированное освещение - сочетание направленного и рассеянного света.

При освещении искусственными источниками пользуются следующими видами освещения:

- Заполняющий (общий) - равномерное бестеневое освещение объекта.
- Рисующий - основной световой поток, дающий контрастное освещение.
- Моделирующий - узкий направленный пучок света малой интенсивности, использующийся для передачи объёма и смягчения теней.
- Контурный (контровой) - задний свет, который используется для отделения объекта от фона и создания его контура.
- Фоновый - свет, освещающий фон за объектом.

## #125.2 Виды осветительных приборов

Световые приборы классифицируются в соответствии с их цветовой температурой.

Осветительный прибор с цветовой температурой, соответствующей цветовой температуре солнца (5000 К), будет давать свет, который называется „дневным“.

Осветительный прибор с цветовой температурой от 3200 К до 5000 К будет давать более оранжевый свет по сравнению с дневным.

### #Типы ламп и их характеристики

Вольфрамовые лампы - цветовая температура составляет примерно от 2200 К до 2800 К - обычно используют для имитации дневного света, необходимо использовать фильтры или настройку цветового баланса камеры, чтобы убрать оранжевый оттенок,так как они работают при высокой температуре, поэтому дают более высокую цветовую температуру.

Галогенные ламы - цветовая температура варьируется от 2800 К до 3000 К.

Металлогалогенные лампы (HMI-лампы) - цветовая температура от 2800 К до 15000 К - эффективны в потреблении энергии, дают сбалансированность под дневной свет.

Люминесцентные лампы - цветовая температура находится в диапазоне от 3000 К до 15000 К в зависимости от вида цвета. Такие лампы тратят меньше энергии на нагрев, чем вольфрамовые и галогенные, представлены широким диапазонов не только различных видов цоколя, но и цветовой температуры, Обладают относительно высокой светоотдачей - отношением светового потока к потребляемой мощности.

Светодиодные-белые - диодных приборов существует большое разнообразие: рассеивающие и линзовые, тёплой и холодной температуры. Такие приборы наиболее энергоэффективны и выделяют минимум тепла по сравнению с другими видами ламп. Это позволяет использовать их с автономным питанием. У многих таких приборов есть возможность плавно менять цветовую температуру за счет комбинирования теплого и холодного света в светодиодных панелях.

### #Виды осветительных приборов

#### #Отражатели

Мобильная конструкция из каркаса и натянутого на неё светоотражающего материала, которая помогает смягчать нежелательные тени или выполнять роль моделирующего источника света. Может использоваться для заполняющего света, когда основным светом выступает естественное освещение.

![](https://lh7-us.googleusercontent.com/SGL4BYB-vkP8904qASCjXqwlmxGp4vFEhYd_osfP9oJpoCcTmlPeC42sJKKHLCNKTSfNcEH9nc_u5k5zkMFU0vVw27nsvQRCs0ejEuUpFxGsEiohhd0qIY9iEHSCN003RP848jQUE6UTHxL3COx36Q)

# #Отражатель Godox RFT-05

#### #Линзовые прожекторы.

Фокусирующие прожекторы составляют большинство управляемых световых приборах. Устройство включает в себя дифракционную линзу Френеля - пучок параллельных лучей фокусируемого света позволяет сохранить интенсивность на большом расстоянии.

![](https://lh7-us.googleusercontent.com/oT827ZeK6X2J5kfTXSYHrAvNQwfTUFa40OW82nVUszo1Ny6iQJ9aq9vAfgd7WZzPLG7yH6usiidvu8TTAF17vXrxNqtx41ltRTR1s1KJUG6h3P7f15b2gn4GuYt7Zv-5GoluvowBMsa2vILw81MwKQ)

Линзовый прожектор DIATHEATER FRESNEL 200 W ZOOM 15-55

#### #Нефокусирующие лампы

Более бюджетный вариант по сравнению с линзовым прожектором. В лампах такого типа встроен отражатель с определённым углом освещения.

![](https://lh7-us.googleusercontent.com/VIetfjCi644tRT97eXsbCbbHvGBCjxMHQ9J7lim9znlPxWM_Ly4Ce6UbkXQ4PDnba9ccx1WXAgbUt_Gltvw4mC1V0UCr23WOCXp-U_dN2qGqJjA8cEnB2NZPuMjWaNhjVH1ufijutKI4RVoGQmq8ww)

Светильник Selens

#### #Открытые светильники

Открытый осветительный прибор создает жесткий свет, отбрасывающий резкие тени на объект. Он не дает ничего, что могло бы отфильтровать объект от света лампочки.

#### #Софтбокс

Изделия разнятся формой, бывают прямоугольными, восьми- и шестнадцати угольными, что обеспечивает определенный эффект светового потока.

Основное преимущество использования софтбоксов заключается в получении смягченного, но четко направленного светового потока. Поэтому для работы в помещении такой тип оборудования является наиболее предпочтительным.

![](https://lh7-us.googleusercontent.com/kz0Tyi7Zfa8yXHqjl1NQlURWTgJvB0DI3mfewH-VoS_zb3ifCfOyeT58sLmZRzEceCMPEnduoUYhQTRuFkmi8n4Z4Ia-6LkQuD0rMppLF8q8DPt4tFm7dvISLc2hCJiaslIn9rotBQoIuN5IKP7xDQ)

# #Софтбокс Broncolor 120x180

## #125.3 Светильники LED.

Светодиоды — это источники большого разнообразия света.

Основные преимущества такого вида осветительных приборов следующие:

- Низкое потребление электроэнергии. Светодиодные приборы могут работать от стандартных источников переменного тока, 12-вольтового питания от адаптера или бортовой автомобильной сети, или от батарей.
- Широкий спектр возможного освещения за счет комбинирования теплого и холодного света в одном осветительном приборе. Можно плавно менять цветовую температуру.
- Мало греются.
- Устойчивость к большим эксплуатационным нагрузкам. Не содержат бьющихся стеклянных элементов, неприхотливы в работе на морозе, в отличие от люминисцентных ламп

Внешнее исполнение LED-ламп:

- Светодиодная лента. Гибкая плата с равноудалёнными друг от друга светодиодами.
- Панели. Крупные осветительные приборы, обычно предназначенные для освещения больших помещений.
- Прожекторы. Оборудование, использующееся для подсветки рекламных конструкций, витрин, а также в съёмке.
- Софиты. Источник света в такого рода моделях расположен на подвижной части светильника, основание которого крепится к стене или декоративному потоку.

### #Характеристики и параметры светодиодных ламп

Мощность и световой поток

В отличие от ламп накаливания у светодиодных светильников отсутствует прямая связь между мощностью и световым потоком. типовая величина светового потока лампы накаливания на 1 ватт паспортной мощности — ориентировочно 12 люмен. Для светодиодной же лампы - на 10 Вт световой поток — 600-700 люмен.

Световая отдача

Для оценки качества светодиодного источника принято учитывать такой косвенный показатель, как световая отдача. Он показывает сколько единиц светового потока излучает светильник на 1 Вт подводимой мощности. Так светодиодная лампа мощностью 10 Вт со световым потоком 700 люмен имеет световую отдачу 70 люмен на ватт.

Цветовая температура

Параметр, характеризующий излучение, испускаемое телом. Значения для разных источников света представлены ниже в таблице.

![](https://lh7-us.googleusercontent.com/jrL2EvvbgYBKhI04x7gXVAPb9W_HZnadbmMDZHkaoiXGGIS18V7R1hd5mCFUru0sgNj60L88-EFD0mAHVOfz7Pnjo_IaUbOUFeKsXSvQY3eZgmD0tsbE_IO_aVSpYRa4SiBHZOl8vDjb_GVACfLnOQ)

Таблица цветовых температур

Коэффициент пульсации и качество драйвера

Качество светодиодного источника света определяет не только качество установленных в нем светодиодов, но и параметры источника питания или драйвера. При питании от сети 220 В низкокачественные драйверы. Для контроля за качеством света был введен такой показатель, как коэффициент пульсации. Он выражается в процентах, у светильников достойного качества коэффициент пульсации не должен превышать величину 5%.

Индекс цветопередачи

Параметр (обозначается как CRI или Ra) характеризует степень соответствия естественного цвета объекта видимому цвету этого объекта при освещении его источником света. Принято считать, что светильники хорошего качества имеют индекс цветопередачи больше 80 единиц. Свет от ламп накаливания сравним с солнечным, поэтому CRI в этом случае приближается к отметке 100, как и у галогенных ламп. Самый низкий Ra имеют ртутные и натриевые газоразрядные осветительные приборы – менее 40.

Индекс согласованности телевизионного освещения

Параметр (обозначается TLCI) количественно определяет цветопередачу освещенных объектов, когда они проецируются на дисплей через камеру. Видео и изображения, снятые при освещении с высоким TLCI, имеют более высокую цветопередачу, чем видео и изображения, снятые при обычном светодиодном освещении, что позволяет пользователям наслаждаться естественным, ярким и красивым изображением на экранах.

## #124.1 Свет в студии

Основа эффективного освещения видеосъёмки это - трёхточечная схема освещения - она применяется при любом стили съёмки для получения качественного изображения.

В идеальной трёхточечной схеме освещения используются:

- источник направленного света
- источник заполняющего света
- источник контрового света

Помимо упомянутых источников, могут быть также задействованы приборы для освещения фона, подсветки глаз и др.

## #124.2 Источники освещения и оборудование

### #Источник направленного света

Он направлен на основной объект. В классическом варианте такой источник света располагается по углом 45 градусов относительно линии прямой видимости, проведённой от камеры к объекту. Установлен источник на подвесной системе или осветительной стойке между объектом и камерой на такой высоте, чтобы тень он носа человека в кадре не достигала уголка верхней губы. Если „в кадре“ несколько человек, обычно используют несколько источников направленного света, чтобы все объекты были освещены.

В качестве прибора направленного света используются линзовые светильники с различными типами ламп - чаще классические галогенные, - а так же приборы дневного света. Цвет может быть откорректирован с помощью гелевых фильтров, которые позволяют значительно снизить световой поток. Также световой поток можно снизить регулировкой напряжения на входе светильника (такой подход используется для светодиодных ламп).

![](https://lh7-us.googleusercontent.com/APftS_eLi7R6Wq8bnvB1wy4mBtNnfP-z8nd41qPNoBFTrEA4UXZrrXP4GogXsJOOiwgInYzLJYzdxRUbs_BHdCStT27XfK5SwZyjhV-m_VzAQWRu8QC5JKlTDznOP48ySI_nYSqya4nBtVGESLOnBQ)

Направленный свет

### #Источник заполняющего света.

Освещение направлено на смягчение теней, образованных от источника направленного света. Заполняющий свет может формироваться рассеивающим, линейным или точечным источником света, выбор источника будет влиять на резкость и контрастность теней объекта.

В качестве источников заполняющего света используют различные светодиодные панели, флуоресцентные и линзовые осветительные приборы с софт-боксами, так же для смягчения теней используют отражатели, хоть к источникам света их отнести однозначно нельзя. При выборе LED панелей стоит обращать внимание не только на качество сборки комплектации, но и на значения индексов CRI (индекс цветопередачи) и TLCI (индекс согласованности телевизионного освещения), чтобы избежать проблем с получением зелёного или красного оттенков итогового изображения.

![](https://lh7-us.googleusercontent.com/EUzbgoLCR4GiYll-o1Zm_8XTDddU_ApTQM8-I5s-vroUWFq26kaJIKILb9V-SBORlvh72Nf3I4Xgrli45cZu4TLuQBdtaD9CYX2cchLPnDn1zhZgcHhSAfTCWyAhh1A7k2XaFn_pR6_nyJjSbdJWGQ)

Направленный свет + заполняющий свет

### #Источник контрового света.

Прибор задней подсветки, использующийся для отделения объекта от фона. Обычно такой светильник подвешивают напротив камеры значительно выше.

В качестве источников контрового света используют линзовые прожекторы или светильники с асферической линзой. Среди ламп чаще встречаются галогенные или диодные.

![](https://lh7-us.googleusercontent.com/EpiyNYuuF6v7CUzQCyK4V3_gw1f1Rrt-sUTcG7JQstFVVN36cFvPV2nFwy_ZW4QhR8fH0tqcJ19g55Zl3qGBUdJcu7c8xDTq3BX_sYEF_R7uaGbQVpiBv2jzNK2_Rwz8ectBV5h1W34kxvTWjtzGPQ)

Направленный свет + заполняющий свет + контровой свет

При необходимости можно также использовать дополнительные виды подсветки. Например, глазной осветитель, который применяется для подсветки глаз, - это компактный осветительный прибор небольшой мощности, который установлен, как правило, на самой камере таким образом, чтобы свет отражался прямо по центру зрачка объекта.

Фоновый свет используется для освещения студийных декораций. Особое внимание при этом стоит уделять свету при работе с Chroma Key, об этом мы расскажем далее.

![](https://lh7-us.googleusercontent.com/1rV1JuXPNFagFMiNAaVszcsXfuAfFyGx1S_CnXSgzTL_8N8oy1xxOsh-oRg1oKqIQJEEEvGQS63wCgf0PMKt8VrB21-JBuXM5DFt9kJwMlcTrEAVR7UFxAWQBrayGhRgP1xlgmJltfOoxjLjRw_f2g)

Направленный свет + заполняющий свет + контровой свет + фоновый свет

## #124.3 Свет при работе с Chroma Key

В отличие от традиционного освещения, основанного на контрасте и балансе между светом и тенью, освещение зелёного экрана зависит от равномерности и постоянства. При работе с хромакеем любой участок фона должен быть освещён равномерно и корректно экспонирован, так как дисбаланс в освещении хромакея усложняет процесс кеинга - удаления зелёного фона.

### #Освещение зелёного экрана в качестве фона

Для хорошего освещения фона необходим мягкий свет, для такой задачи подойдут большие, мягкие источники освещения, например, светодиодные светильники с большим рассеивателем. В отличие от тех же светильников, но без рассеивателя, они исключают явный фокус с зонами уменьшения яркости, освещая фон равномерно. Хорошим вариантом будет использование двойного рассеивания, в таком случае светильник сначала рассеивается  софт-боксом (8х8), а затем стандартным рассеивателем (софт-боксом 4х4).

### #Расположение источников света при работе с Chroma Key.

Классическая схема расположения освещения и объекта в кадре такова:

- Объект расположен в двух-трёх метрах от фона;
- Два-три светильника освещают фон, классическое расположение светильников - по разные стороны хромакея под углом примерно 45 градусов;
- один-два контровых светильника за объектом.

![](https://lh7-us.googleusercontent.com/YixTj2CAGgfvVWFIQxgjN99yqZzOr52SBzSsSoLc514HtU2T0vZPvo5fM9dPL7J3YzdQMRHu0sOOCd7S_-Y3rNq6fM8e4GOUKiTd4U4SA1pjLUvhdta_oN4SYoLbmfFUD-B103XSFS0jrVn9kAPDUQ)

![](https://lh7-us.googleusercontent.com/sp-c5A9gfNsIP4pqc1TKEDvxXF6TsxgnMUsHvD7NUucb51xMy9rEGtHlswwomQE-a9hcPIVdEGG9--ZP0eYAWFAb2xaA6PJN8o9x7JCeXR7ycagu93EuKK4v6lsViTSaZI1OuhIySldM9f1BuiMVTw)

![](https://lh7-us.googleusercontent.com/KdaM78MCr4RrrWq2JG8eHNUcR9CgINOR0rG2el5aVSbJQfWVSW6hrt_MAMxCodH42K31FspP1dHULTp-WqiDuCQymZkvJN3SM7b4YpdOGmii1TsxugPp_cJCx527_Ry7ENc5eqz9AG9Ky2u1jp_FaA)

## #124.4 Схемы освещения и их практический смысл

Использую трёхточечную схему освещения по-разному и меняя экспозицию, можно влиять на восприятие изображения зрителем.

Человеческому глазу привычно наблюдать картину, когда объект равномерно освещён естественным светом, направленным под углом сверху. Исходя из этого другое расположение освещения влияет на эмоциональную атмосферу кадра.

Источник над головой (рис.1).

![](https://lh7-us.googleusercontent.com/GtH5gNp_pTt46rEb58g6Fhc_zt7qUCQhWmUmRlRhOZjyc74VozM0SmLpgti-cc_thMQfOsi76Y9lhG0FEcNVPzt9EBzux6one_TB2H-ndD_nFTsFhwJFO1SQA_3TGKMuhi4UHxwZzoB1_Ad9VoDbGg)

рис.1

Такое освещение создаёт впечатление, что объект находится под искусственным источником света, так как в реальной жизни солнце практически никогда не находится в таком положении. Источник, расположенный слишком высоко, выделяет сразу нескольких проблемных зон: тёмные глазницы, тень под носом, тёмная шея.

Источник снизу (рис.2)

![](https://lh7-us.googleusercontent.com/C0rnj49tsS9zP1zJC_0EQZFX6qsL35_KryvI26vGHEzV4Xu-HXXqp4jWlng2GpmuI8jh9GOtsfrK8CfNxdUYy4fRHCQi3frp6vxWBia7OnEqlnVZajn5braJmdmVNOJGyAZJJoO_Z3HCVhDCJTcb3Q)

рис.2

Лицо освещено снизу, что вызывает странные ощущения у зрителя. Двухмерная фотография не может дать нам полного представления о трёхмерном лице. Поэтому мозгу приходится достраивать информацию об объёме.

Зависимость изображения от положения источника света (рис.3).

![](https://lh7-us.googleusercontent.com/HDKOkSFCbPhTIBHrdXgdkDe6NcK1Mr2RBqP-nC32e7KMINXr3JBFBOavMjhbRYGOzq8CqYcIiBq-PW-qyRmjldttzFEuDGoQN2N2xD5OiuJhZ0rB3kVOYZImLKq3jCBhKsbS-L_RM8gTOKMhFbKFjg)

рис.3

Некоторые фотографы ошибочно полагают, что наклон софтбокса меняет направление света, что если софтбокс наклонить вниз, то и свет на человека будет падать сверху. Это неверно. Чтобы избежать ошибок с нижним светом, источник должен находиться не ниже головы человека.

Свет сбоку (рис.4).

![](https://lh7-us.googleusercontent.com/hZNlLZq_q9tSoXr_BGPHAwi2462MkpZmVWjBXkGVYlknXedGWtjZNkuuvLDbHCC-dwWV7iIkdBnuc1yWw6oFUG-I2Kr4K4APrKW9FsxFKHxZ22qXBnWK975T533f8IiYc0Lz4gkpBz8vHMJogHO0Lw)

рис.4

Свет снизу не всегда создаёт негативный эффект. Например, когда он не является основным источником света, а используется для частичной подсветки теней, нижний свет может создавать правильные акценты.

# Получение звука со встроенной и внешней звуковой карты и гарнитуры

Первое, чему стоит обучиться при съемке видео, как ни странно, это запись качественного звука. Видео с плохой картинкой, но хорошим звуком воспринимается намного лучше, чем ролик с качественным видеорядом, но плохим звуком. Ссылку на исследование можете найти в дополнительных материалах.

Чтобы компьютер мог захватить звук, ему необходима звуковая карта - это встроенное или внешнее устройство, имеющее входы и выходы аналогового звука, иногда и цифровые тоже.

Обычно в компьютере есть встроенная звуковая карта и в современных компьютерах для записи голоса, как правило, такой карты хватит. Надобность в специфическом оборудовании возникает, если вы захотите использовать, например, микрофон не бытового стандарта, а профессионального. У них на один звуковой канал не два, а три провода. Это называется “балансный звук”, а бытовой, соответственно, – “небалансный”. Подключить балансный микрофон в небалансный вход можно, но звук вам не понравится.

Профессиональный стандарт – это не значит, что микрофон будет дорогой или гарантированно качественный. Это лишь значит, что соединение микрофона и звуковой карты будет через разъём с тремя контактами и сам разъём будет или XLR, или большой TRS, который в народе называют джеком.

Чтобы такой источник звука включить в компьютер, можно пойти разными путями:

1. Использовать специальный преобразователь балансного звука в небалансный. Это небольшое аналоговое устройство, имеет разъем XLR для микрофона и небалансные выходы микрофонного и линейного уровней.
2. Взять аналоговый аудиомикшер, у которого на выходе есть обычный небалансный звук, обычно в виде разъёмов RCA, в народе их называют тюльпанами.
3. Взять аудиомикшер со встроенной звуковой картой. Такой микшер  в компьютер включается через USB и видится в системе как звуковое устройство.
4. Взять внешнюю звуковую карту – такие устройства часто называют “аудиоинтерфейсом”. Они также видятся, как звуковое устройство.

Бывают микрофоны и гарнитуры с USB интерфейсом прямо на проводе. Среди них попадаются весьма качественные. Использование микрофонов с XLR-разъемами, микшеров и прочей техники, работающей с балансным звуком, оправдано, когда у вас планируется некоторое разнообразие звуковой техники – тогда удобно иметь стандартное, общепринятое в этой области оборудование. Если же вы просто хотите записать видеоролик с приличным микрофоном, сидя рядом с компьютером, где проходит запись, и оснащаетесь с нуля, то проще взять хороший USB микрофон и не возиться с промежуточными устройствами.

Дополнительная встроенная или внешняя звуковая карта может понадобиться, если требуется высокое качество звука. В данном случае речь не столько о субъективном качестве, сколько о технических характеристиках устройства: профессиональные карты позволяют оцифровывать звук с частотой дискретизации 96 килогерц против максимум 48 у бытовых карт. Обычно эту разницу не слышно, но при обработке избыточная частота оцифровки оставляет запас для преобразований, потом звук будет приведен к бытовому стандарту, но промежуточные преобразования будут проводиться на более качественном материале.

# #Захват звука по сети

Разберем еще один способ захвата звука: по сети, например, через кодер.

::: info
Кодер -- это устройство, на вход которого подается видео и аудио сигнал, а на выходе получается сетевой поток.

:::

На входе это может быть HDMI или VGA как видеоисточник и аналоговый небалансный звуковой вход линейного уровня, или тот же HDMI – по нему тоже можно принять звук.

На выходе – сетевые потоки. Например, закодированные кодеком H.264 и передаваемые по протоколам RTSP или NDI.

Сетевой кодер не подключается напрямую к компьютеру, это позволяет работать с ним удаленно – как в одной локальной сети с получателем потока, так и через интернет, хотя, тут есть свои особенности.

Опять мы встречаемся с этой разницей между сигналом и потоком.

::: info
Сигнал – это понятие в нашем случае электрическое, а поток – информационное. Сигнал можно описать изменением напряжения в проводе, а поток – данные, передаваемые между источником и получателем по определенному протоколу.

:::

В нашем случае, звук с микрофонов можно отправить с помощью сетевых потоков, скажем, на компьютер режиссера. Таким же способом можно будет передать картинку по сети – не просто так в кодерах есть видеовходы.

Для примера возьмем бюджетный сетевой кодер, работающий с протоколом RTSP. Такой же протокол используют IP-камеры, так что уметь работать с ним полезно.

Чтобы захватить через него звук, необходимо знать адрес кодера в сети. Сейчас у нас будет простой случай, когда компьютер с OBS и кодер находятся в одном сегменте локальной сети – в домашних условиях и небольших офисах обычно так и есть. Захватить этот поток в OBS, удобнее всего с помощью gstreamer. С gstreamer для работы с потоками мы будем сталкиваться все время – он лучше всего умеет работать  с потоками в реальном времени. В OBS необходимо установить плагин “obs-gstreamer”.

Тут расскажем об установке на Windows, инструкции по установке в других операционных системах смотрите в материалах курса.

Процесс установки начинается с установки самого фреймворка Gstreamer. Для этого скачиваем с официального веб-сайта установщик и устанавливаем путь к фреймворку в переменную окружения PATH. Далее нужно установить плагин obs-gstreamer. Для этого необходимо скачать с официального сайта файл библиотеки и закинуть его в эту папку. Ссылки на все необходимое  можно найти в дополнительных материалах. После этого нужно перезагрузить компьютер и можно запускать OBS. Если в процессе установки у вас появились трудности, загляните в дополнительные материалы. Также можно включить энкодер Gstreamer для увеличения скорости обработки видео. Теперь можно использовать источник gstreamer, куда надо вставить следующий пайплайн. Пайплайн это команда инструмента gstreamer, в которой указан источник (в нашем случае RTSP-источник, где после слова location вы должны вставить адрес своего RTSP-потока или SRT-источник, где после слова uri вы должны вставить адрес своего RTSP-потока), назначение (имя audio., которое является встроенным в OBS именем назначения), а также энкодеры, парсеры и так далее. Более подробно об этом будет рассказано в уроке про фреймворк Gstreamer позднее.

Другой протокол, который нам пригодится – NDI. Если RTSP используется для сжатых потоков, то NDI применяется в телевизионном производстве и потоки тут тяжелые, по 100 мегабит видеопотока FullHD. Поэтому используют NDI в основном в локальной сети.

Есть сжатая версия NDI (NDI|HX). Здесь совмещается “упаковка” от NDI-устройств и поток от RTSP-устройств (то есть, сжатый до нескольких мегабит в секунду). Бюджетные камеры и кодеры, в спецификации которых заявлена поддержка NDI, как правило, поддерживают именно эту версию -- NDI|HX.

Есть два способа получить звук по NDI: использовать программу на компьютере или воспользоваться кодером – устройством, аналогичным тому, что мы рассматривали ранее.

Для того, чтобы получить звук с помощью программы нужно скачать весь пакет приложений ndi. На отправляющем компьютере необходимо запустить NDI Screen Capture, а на принимающем NDI Studio Monitor. В источнике NDI OBS увидит тот сигнал, который будет приходить с отправляющего компьютера. Если же необходимо получить звук с компьютера, на котором нет приложения ndi, то можно воспользоваться кодером. С помощью провода HDMI передаём сигнал на кодер.

Некоторые сетевые устройства умеют получать питание от сети. Но для этого сетевой коммутатор должен поддерживать технологию PoE. Для ОБС нет разницы, откуда пришел поток NDI – с программного или аппаратного источника.

Обычно камеры поддерживают питание от PoE, а кодеры -- нет. Но можно использовать активный сплиттер питания, который из PoE (Power over Ethernet) делает отдельно “power” 12В / 2А  и отдельно “Ethernet”.

Иногда вам может быть необходимо записать несколько источников сразу. Например, есть основной эфир, но при этом вы также хотите писать выходы всех камер одновременно. Или вы просто хотите иметь чистую запись без оформления и титров. Встроенными средствами ОБС это сделать не получится, поэтому необходимо поставить ещё один плагин. Запись эта будет не чистой, а перекодированной.

Теперь в фильтрах сцен появится опция “source record”.

Из предлагаемых вариантов для удобства синхронизации со звуком используем “стрим или запись”. Если вы одновременно пишите несколько источников в одну папку, то у них совпадает время начала записи, а следовательно и имена.  Поэтому нужно изменить формат названия видео.

Плагин также позволяет рестримить конкретный источник на удаленный сервер, но про потоковую передачу нескольким получателям мы поговорим позднее.

Важно, что звук на запись попадает как источник. Если вы записываете видеоигру, то звук оттуда не попадёт на запись, потому что он не приходит в ОБС как звуковой вход.

Забрать звук отдельно можно несколькими способами. Если видеоигра - единственный внешний звук, который нужно завести в ОБС, то можно воспользоваться приложением audio cable. Оно создаёт виртуальный микрофон внутри компьютера. С помощью него можно создать виртуальный вход, на который выводится звук приложения. А потом звук, полученный с этого входа, передать в любое другое приложение на компьютере.

В игре может не быть настроек выходного аудио-устройства. В этом случае запустите игру, выберите в настройках устройства воспроизведения операционной системы  звука вход виртуального аудио кабеля. В OBS выберите захват выходного аудиопотока. В этом случае вы не сможете слышать звук игры, потому что его забирает OBS. Чтобы это исправить, необходимо выбрать в микшере звука настройки, а в них в строке с этим захватом выходного звука в столбце Audio Monitoring выберите

Monitor and Output. Теперь звук будет и в сцене, и будет слышен через колонки или наушники.

Но если вам нужно получить звук нескольких источников, то стоит воспользоваться более универсальном решением. В ОБС с версии 28 эта функция предустановлена автоматически. Для старых версий необходимо установить плагин.

Создайте отдельную сцену для вех аудио источников, которыми вы хотите управлять. Мы будем добавлять её во все остальные сцены. Затем добавьте источник application audio capture. Как следует из названия - эта штука захватывает звук конкретного приложения, следовательно, сначала вам нужно открыть игру, видеочат или другое приложение,  потом найти приложение через этот источник. Для каждого отдельного приложения нужно создать отдельный application audio capture. Теперь вы можете регулировать громкость приложений в вашей записи.

# #Куда и как стримят?

Чтобы начать потоковую передачу, необходимо сперва  узнать о том, куда можно стримить и какие параметры потоков ожидают увидеть стриминговые площадки.

Выделим следующие виды платформ для стриминга:

1. Соцсети
2. Видеохостинги
3. CDN -- сети доставки контента
4. Специализированные видеоплатформы для стриминга

### #Соцсети

Платформы имеют немного разные требования ко входящим потокам. Выберем платформы для примера и с ними будем работать. Если вам понадобится другая платформа, вы увидите, что по настройке они обычно похожи друг на друга.

Из соцсетей и чатов выделим  ВК, Одноклассники, Фейсбук, Телеграм.

Инстаграм пошел своим путем и снаружи потоки не принимает – только с камеры смартфона. Возьмем для примера ВК и телеграм.

В ОБС в настройках стрима уже есть адреса многих стриминговых площадок, но  Телеграми и ВК там нет. Поэтому выбираем параметр custom. Как видим, от площадок нам нужно получить всего 2 параметра: адрес сервера и ключ стрима. В ВК эта информация находится в разделе “видео”. Нажмите на кнопку нажать эфир и выберете, куда вы хотите стримить - к себе на страницу или в сообщество. Чуть ниже находится ссылка на rtmp сервер и ключ трансляции.

В телеграмме стрим сделать чуть сложнее. Трансляцию можно запускать только в частном  канале из приложения. Ссылку на трансляцию Телеграм также не предоставляет, но сохраняет запись в сообщения сообщества.

Rtmp сервер и ключ трансляции находятся во вкладке stream with в этой кнопке

![](https://lh7-us.googleusercontent.com/jfr9zaxmOWwDzpeCInNrg931xbsckkTe4DaFwy-qqXMxDnwzW5ZJfiHMxJIpFvXIknBCF4mBAF2VLargeIWZ4LniT5jj8_G-_kTTSadvJjfrImzuowBhNgBwfPqemgQVTdB9rNSr_Y1AT9XCGVGOhV6Qw1Ln9A98VA5qSkHKbgSvQhSs8t4W4y2l1XFdSmYl)

Видеохостинги. ЮТ, дальше надо посмотреть импортозамещение и забугорные аналоги. Вам вообще полезно их знать.

Наверное, самые известные платформы для стриминга -- это Ютюб и Твич. Адреса их RTMP серверов есть в ОБС. Нужно только вставь ключи или залогиниться. Если вы логинитесь, OBS сам получает ключи на сервере через программный интерфейс.

При стриминге некоторые платформы предлагают два варианта организации трансляции: постоянный канал и события. Канал -- это постоянный адрес. Если вы ведете передачу, то ее видно по этому адресу, если закончили, то ничего не показывается. Всё как в эфирном телевидении. При стриминге по событиям за каждым событием закрепляется свой адрес, по окончании события показывается его запись. Так работают, например, ютьюб и ВК.

Стриминг событий удобнее делать в формате событий -- это удобно для зрителей. Но на передающей стороне надо помнить, что при обрыве связи сервер может посчитать ваше событие законченным и станет показывать запись того, что удалось принять до обрыва. Дальнейшая передача будет приниматься сервером, но показываться не будет. Например, ВК просто тихо добавляет такие “продолжения” эфира в разделе “Видео”.

Ключи трансляции нужно хранить в секрете. Завладевший вашим ключом сможет перехватить поток и показать свой контент у вас на канале -- вероятно, что не совсем то, что вы планировали.

В последнее время популярность набирает Дзен, но трансляцию там могут сделать не все. У вас на канале должно быть не менее тысячи подписчиков, если вы ведете трансляции через мобильное приложение, или ста подписчиков при трансляциях с компьютера. На канале также должна быть подключена монетизация. Администрация платформы также оставляет за собой право отключить вам эту опцию.

### # Сети доставки контента

CDNVideo, NGenix, Akamai

Сети доставки контента -- CDN -- это специализированные видеоплатформы для стриминга. Их основная задача -- раздать вашу трансляцию множеству зрителей, как правило, распределенных географически.

Дополнительные сервисы -- это платные просмотры (пейволлы), многопоточные трансляции, в которых зритель может сам выбирать поток (камеру или презентацию), управление комментариями и так далее.

### #Прямой эфир и реальное время

Когда мы говорим про прямую трансляцию в интернете, нужно понимать, что существует разное понимание прямого эфира. Это не всегда передача в реальном времени. Вот несколько ситуаций, где задержка звука или картинки критична:

- Разговор по телефону. Вы сталкивались с ситуацией, когда в разговоре ваш собеседник начинает говорить невпопад или неожиданно долго молчит в ответ на совсем простой вопрос? Телефония стала цифровой, использует кодирование и составные каналы связи. Все это вносит задержку, и от телефонистов мы можем взять ориентиры по нормам этой задержки. Есть протокол G.711, используемый в телефонии, который определяет норму задержки передачи сигнала в одну сторону в 150 миллисекунд. Считается, что уменьшение этой задержки не вызовет заметного ощущения “живости” беседы, а увеличение сделает задержку заметной и раздражающей.
- Получение изображения с цифровой камеры, а звука с аналогового входа. Аналоговый сигнал проходит свой тракт без задержки -- он может усиливаться, фильтроваться, но задерживаться ему просто негде. В аналоговых системах нужно собирать специальную схему, чтобы задержать сигнал, называется “линия задержки”. А цифровое изображение подобно описанному ранее цифровому звуку в телефоне, кодируется, передается по сети или шине вроде USB, потом декодируется -- все это происходит не мгновенно. Задержка может быть пренебрежимо мала, как в случае с веб-камерами, подключаемыми по USB, а может достигать неприлично больших значений, как в случае с сетевыми потоками, которые еще и воспроизводятся с буферизацией, а без нее не воспроизводятся. Мы с вами как раз с такими потоками и учимся работать в относительно реальном времени.  
  Какая здесь возникает задержка и что делать с рассинхронизацией видео и звука?  
  Мы помним про ориентир, данный нам телефонистами. Теперь посмотрим, что может выступать ориентиром у телевизионщиков. В цифровом видео есть дискретная величина -- частота кадров. Не во всех кодеках, кстати, она постоянная, но будем придерживаться телевизионных стандартов. В европейских стандартах PAL и SECAM -- 25 кадров в секунду, в американском NTSC -- 30. Итак, минимальный квант времени -- одна двадцать пятая секунды, то есть, 40 миллисекунд. Дальше -- это вопрос внимательности зрителя, опытные видят смещение в один кадр, но на практике 2-3 кадра можно допустить, больше уже заметят даже случайные в этом вопросе люди. Итого, придерживаемся планки 120 мс. Здесь мы говорим именно о рассинхронизации. Если же вы получили несколько потоков с большей, но при этом одинаковой задержкой, а также задержали звук на соответствующее время, то допустимая величина этой задержки ограничена лишь вашими задачами. Например, если режиссер прямого эфира не дает указания операторам, то задержка существенной роли не играет. Более того, если режиссер находится на месте съемки, то у него появляется запас времени на реакцию. Запускают на экране видеоролик -- можно успеть переключить микшер на захват экрана к началу ролика. Оператору или режиссеру, который говорит оператору, что нужно сделать, задержка будет мешать. Представьте, что вы ведете автомобиль, а на ветровом стекле задержка в пару секунд.
- Если вы записываете речь или вокал и слышите себя с задержкой, то вы будете слышать даже минимальные задержки, поэтому в микрофонах или звуковых картах с цифровым выходом обычно делают аналоговый выход для наушников, там используется прямой аналоговый тракт.

Мы разобрали случаи, когда требуется доставка сигнала или потока в реальном времени и допустимые величины задержки. А теперь посмотрим на стриминг в соцсети.

Когда идет трансляция футбольного матча, то зрители эфирного телевидения видят гол раньше, чем зрители онлайн-трансляции. Эфирный телевизионный сигнал имеет свою задержку, но она несравнима с задержкой из-за буферизации в интернет-трансляции. Передача видео для большой аудитории через интернет устроена так, что меньше 12-15 секунд задержка там обычно не бывает, а в описанном случае с футбольными матчами “гол” кричат за стенкой на полминуты раньше, чем у вас покажут в интернет-трансляции -- можно успеть открыть сайт с трансляцией и все самое интересное увидеть в как бы прямом эфире. Это мы подробнее разберем в теме про протоколы потоковой передачи, но здесь резюмируем: задержки в дистрибуции, то есть, доставке видео конечному зрителю не так важны, пока не нужен интерактив.

Если вы смотрите футбол, то повлиять на исход игры вы вряд ли можете, а если идет конференция и вы задаете вопрос хотя бы в чате, то при такой задержке вопрос рискует прийти, когда выступает уже следующий докладчик.

Поэтому важно не путать два жанра: видеотрансляцию и видеоконференцсвязь, то есть, общение в реальном времени двух и более, но все же ограниченного числа людей. Для видеосвязи используются другие инструменты и протоколы, там другие ограничения, чем в трансляциях и это мы также изучим далее в теме про протоколы стриминга.

Когда мы начинали заниматься трансляциями в интернет в 2006 году, устроили из МИЭМа телемост с коллегами в Петербурге и наблюдали описанный выше конфуз: из-за задержки в 20 секунд в каждую сторону общение приходилось дублировать по телефону, а под занавес аплодисменты из Москвы прозвучали в Петербурге уже после начала следующего выступления.

# #Стрим нескольким получателям

Отправку потокового видео сразу нескольким получателям называют мультистримингом.

Это можно реализовать двумя способами: либо посылать все потоки прямо с площадки, где работает микшер, либо использовать сервер-посредник.

Существуют сервисы рестриминга, они обычно платные. Использовать ли их -- решать вам, исходя из ваших задач. Здесь подробнее разберем особенности мультистриминга с микшера, то есть, с места съемки.

Узкое место -- это канал связи на месте съемки. Обычно приходится беспокоится, чтобы хотя бы единственный поток не оборвался, готовят дублирующие каналы. Но бывает так, что за канал вы спокойны, можно прямо с микшера посылать потоки на несколько площадок. Просто помните, что битрейт, то есть, использование канала передачи данных, складывается по всем трем потокам и в случае, если канал будет нагружен (не обязательно вами), то вы с большей вероятностью рискуете получить сбой, причем, сразу по всем трем потокам.

Вариант с промежуточным сервером выглядит более надежным и по задействованию канала связи, и по нагрузке на микшер. Про нагрузку на микшер стоит рассказать подробнее.

Когда вы посылаете одинаковые потоки на разные адреса, можно обойтись без отдельного кодирования каждого потока, просто трафик увеличивается соответственно количеству потоков. Если же требования платформ отличаются и нужно готовить для них разные потоки, то на микшер ложится нагрузка по кодированию всего требуемого разнообразия потоков. Обычно микшер -- это персональный компьютер с программой-микшером. Мы в этом курсе разбираем работу с OBS, в коммерческой практике вы можете встретить, например, VMix -- мощный инструмент, но для технологий, изучаемых в этом курсе подходит плохо.

Вот у вас на компьютере работает довольно прожорливая программа, которая должна манипулировать видеопотоками в высоком разрешении, кодировать видео в запись и к этому кодировать то же выходное видео под разные требования -- обычный бытовой компьютер на этом уже покажет перегрузку процессора. Графические процессоры помогают справиться с такими задачами, но часто вычислительные мощности приходится экономить.

К этому добавляются ограничения в управлении и мониторинге трансляцией: режиссер и так занят, а трансляции частенько сбоят. И диагностикой проблем с конкретной платформой заниматься ему некогда, а придется -- тот же ВМикс логи показывает режиссеру на его компьютере, причем, нельзя остановить одну трансляцию, не прервав остальные.

Прерывание трансляции плохо не только тем, что зрители несколько секунд посмотрят на черный экран. Например, ВК при обрыве трансляции на определенное время прекращает событие и дальнейшая передача уже не видна по той же ссылке, там показывается запись. Аналогичное поведение можно видеть у Youtube.

Разгрузить процессор на месте стриминга можно, используя кодер -- такой же, каким захватывается изображение с компьютера в сетевой поток. Мы с такими устройствами будем работать в этом курсе. Кодеры обычно имеют встроенную возможность отправлять поток RTMP, как раз такие потоки принимаются стриминговыми платформами. Включаем кодер в выход для второго монитора, отправляем туда полноэкранную картинку с микшера -- вот и “бесплатный” для процессора способ вести трансляцию и не задумываться о нагрузке. Отметим, что это будет одна трансляция и управлять ею или диагностировать ее проблемы на стороне кодера практически невозможно.

Другой способ -- распределение задач между компьютерами. Если у вас есть возможность взять с собой два компьютера, то можно соединить их по сети (очень желательно -- гигабитной) и использовать протокол NDI для передачи выходного потока с микшера на вход такого же микшера на соседнем компьютере. Теперь режиссер может заниматься своими делами, а на втором компьютере инженер может вести запись и трансляцию, а в случае проблем пытаться их диагностировать.

Если вы решили делать мультистрим со своего устройства, то для этого в ОБС вам будет необходим плагин. Он добавит во вкладку Docks новую графу “multiple output”. Свой  первый стрим настройте как обычно. Дальше перейдите в multiple output и добавьте новую цель. Дайте ей название, добавьте сервер и ключ. Ютуб пишет свой rtmp сервер рядом с ключом трансляции, в отличие от твича. Ссылку на сервера для него вы найдёте в материалах к уроку.

Нужно также решить, требуется ли вам перекодирование. Если в параметрах энкодера вы выберете взять из обс, то нагрузка на ваш компьютер будет гораздо меньше: ему не придётся перекодировать дополнительный поток для другой платформы. Поэтому, если все выбранные вами платформы готовы принять одинаковые потоки и не выставляют особенных требований, то старайтесь избегать дополнительного кодирования.

Трансляция -- это многозвенный процесс, где сбой на любом из звеньев приводит к плачевному результату. Можно слышать прекрасный звук на микшере у звукорежиссера, но надо понимать, что до зрителя этот звук проходит длинный путь и поврежденный кабель или неправильно настроенный уровень сигнала на кодере могут всё испортить. Видеопоток также после отправки на стриминговую платформу проходит, как минимум, два пути: от места отправки до платформы и от платформы до зрителя. Нужно контролировать качество трансляции не только на месте отправки, но и смотреть эту трансляцию с платформы -- убедиться, что не только у вас поток улетел, но и что он прилетел к зрителям. Даже глазомерный контроль позволит заметить отклонения, но кое-что можно и померять.

Самые частые и неприятные проблемы возникают со звуком. В организации видеотрансляции первым делом думают о картинке, а звук -- он же само собой разумеющееся приложение к картинке. Это не так. О звуке надо позаботиться отдельно. Универсальных рецептов здесь не бывает, но несколько простых советов вам могут помочь избежать совсем уж досадных ошибок. Стоит ли говорить, что все эти грабли -- из практики, а не выдуманные для учебного курса…

1. Проверьте цепочку от микрофона до микшера, который отправляет звук на стриминговую платформу. Это то, что вам подконтрольно. Убедитесь, что вы берете звук с того источника, с которого ожидаете, а ненужные отключены. Например, вы подключили микшер к USB входу компьютера и это устройство видно у вас как источник звука, вы берете звук с него, а встроенный микрофон ноутбука надо выключить. Иначе эфир будет дополняться комментариями режиссера.
2. Электроника -- это наука о контактах. Все соединения должны быть надежными. Никаких перетертых кабелей, отваливающихся разъемов и так далее. Аналоговый кабель будет давать шуршание или треск, пропускать фоновый шум 50 Герц, пока не отвалится окончательно, а неисправный USB кабель может привести к исчезновению аудиоустройства из системы.
3. Микрофоны, особенно петличные, нужно вешать так, чтобы они не терлись о ткань одежды, были направлены на рот говорящего, а не в его внутренний мир -- бывает, что вешают внутрь пиджака -- так незаметнее.
4. Уровень звука, особенно цифрового -- это важная и капризная величина. Вы строго ограничены потолком 0 дБ сверху и соотношением сигнал/шум микрофона  в данном окружении и аудиокарты -- снизу.  
   Что значат эти слова:  
   шкала звукового уровня -- отрицательная. Например, у вас хороший микрофон и звуковая карта, соотношение сигнал/шум 90 дБ, в телефоне это отношение может быть 30 дБ. Это показатель отношения мощности полезного сигнала к мощности шума. В полной тишине какой будет фоновый уровень шума с этого микрофона? Смотрим в ОБС -- там есть индикатор уровня. От -60 дБ и ниже -- неплохо, считайте -- хайфай. От -80 и ниже -- отлично, считайте -- студийный уровень.  
   С верхней планкой всё строго: если уровень на аналоговых микшерах, магнитофонах и прочей технике имеют небольшую положительную составляющую, то в цифровых шкала кончается нулем. По нулю звуковая волна будет обрезаться, вы будете терять значительную часть информации, а слушатель будет получать хриплый звук. И низкий, и особенно слишком высокий уровень -- плохо. В первом случае можно сделать погромче, во втором уже ничего не сделать. Ориентируйтесь на уровень микрофонного звука при разговоре от -20 до -12 дБ. Выше, чем -3 уровень не допускайте. Мы коснемся работы со звуком далее в этом курсе, но эти простые ориентиры уберегут от частых проблем.
5. По умолчанию трансляция ведется в стереоформате. Люди часто забывают про это, подключая один микрофон и отправляя звук только в левый канал. Убедитесь, что вы используете стереозвук корректно.
6. Наконец, не поленитесь и на отдельном компьютере откройте поток в чем-нибудь, что показывает уровень звука. Обязательно послушайте в наушниках. Уровень должен быть в разумных пределах (может отличаться от того, что вы отправляете, но не радикально) и не иметь шумов -- ни аналоговых, ни цифровых артефактов в виде бульканья или подрывов. Что делать с этими артефактами -- тема уже не для короткого чеклиста. Если в двух словах: аналоговые -- искать проблему от микрофона до места оцифровки звука, цифровые -- смотреть параметры кодирования звука и на качество связи, хотя, причины бывают, например, в прошивке кодера -- мы сталкивались с такой проблемой, когда собирали звук с микрофонов вместе с захватом презентации с компьютера через кодеры, помогло обновление версии прошивки.

Видео также имеет множество мест, где что-то пойдет не по плану. Общий план мониторинга такой же -- нужно выделить точки, где имеет смысл и доступно проводить мониторинг, не забыть дойти до самой последней -- получения потока “глазами зрителя”. Про диагностику и мониторинг в съемочных комплексах подробнее поговорим далее, сейчас важно не забывать: помимо визуального качества картинки с камер есть технические параметры потока, который будет сводиться в микшере и далее кодироваться для передачи на стриминговую платформу. Желательно не испортить качество картинки хотя бы до сбора потоков в микшере. И здесь играют роль как настройки кодирования камеры, так и настройки объектива или параметров изображения.